# Gutao_Chaodi 注释规范

## 1. 目标

注释用于解释“为什么这样做”，而不是重复“代码已经写了什么”。

本规范适用于 `src/` 下所有 Python 文件，`tests/` 与 `scripts/` 采用简化版本。

---

## 2. 注释层级规范

### 2.1 模块级（必须）

每个 Python 文件顶部必须有模块说明，建议包含：

1. 文件职责。
2. 在系统中的位置（输入层/决策层/输出层）。
3. 关键边界（例如是否允许抛错、是否有副作用）。

### 2.2 函数级（必须）

每个公开函数、关键私有函数必须有 docstring，至少说明：

1. 函数目的。
2. 输入与输出语义。
3. 异常或失败处理策略（如返回 `None`、抛异常）。

### 2.3 逻辑块级（按需）

以下情况必须补块注释：

1. 状态机分支（如 one-shot、开板剔除）。
2. 兼容性兜底（如字段缺失 fallback）。
3. 错误分类逻辑（认证、权限、网络）。
4. 性能或稳定性设计（并发控制、重试、jitter）。

---

## 3. 禁止项

1. 禁止逐行翻译式注释（噪音高，维护成本高）。
2. 禁止过时注释与代码不一致。
3. 禁止在注释中记录临时调试信息（应放入日志或 worklog）。

---

## 4. 推荐风格

1. 注释句式简洁，优先一行讲清楚意图。
2. 优先解释业务原因和约束来源。
3. 对策略规则使用统一术语：
   - 一字跌停
   - 开板剔除
   - one-shot
   - 基线卖一量
   - 阈值触发线

---

## 5. 提交前检查清单

1. 新增文件是否有模块级说明。
2. 修改的关键函数是否更新 docstring。
3. 状态机/错误分支是否有必要块注释。
4. 相关文档是否同步：
   - `doc/Project_Architecture_Guide.md`
   - `doc/Project_Memory.md`
